<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ThermoCalc Web â€” Accurate Thermodynamic Data</title>
<style>
  :root{
    --bg:#f7f9fc; --card:#fff; --ink:#0f172a; --muted:#475569; --accent:#2563eb; --line:#e2e8f0;
    --ink-strong:#0b1220; --btn:#2563eb; --btn-ink:#fff; --btn-outline:#e2e8f0;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.55 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
  a{color:var(--accent);text-decoration:none}
  header{display:flex;align-items:center;justify-content:space-between;max-width:1040px;margin:24px auto;padding:0 16px}
  .brand{font-weight:800;letter-spacing:.2px}
  .nav a{color:var(--muted);margin-left:16px}
  .nav a:hover{color:var(--ink)}

  .hero{max-width:1040px;margin:32px auto;padding:0 16px;display:grid;grid-template-columns:1.2fr .9fr;gap:28px}
  .hero h1{margin:.2rem 0 .4rem;font-size:clamp(28px,4.5vw,46px);line-height:1.15;color:var(--ink-strong)}
  .hero p{color:var(--muted);font-size:18px;max-width:62ch}
  .points{margin:18px 0 24px;display:grid;grid-template-columns:1fr 1fr;gap:10px 24px}
  .point{display:flex;gap:10px;align-items:flex-start;color:var(--ink)}
  .point i{font-style:normal;font-size:20px;line-height:1.1}
  .cta{display:flex;gap:12px;margin-top:10px}
  .btn{appearance:none;border:0;border-radius:12px;padding:12px 18px;font-weight:700;cursor:pointer}
  .btn-primary{background:var(--btn);color:var(--btn-ink);box-shadow:0 6px 20px rgba(37,99,235,.25)}
  .btn-outline{background:transparent;border:1px solid var(--btn-outline);color:var(--ink)}

  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 8px 28px rgba(15,23,42,.08)}
  .calc{padding:18px}
  .calc h3{margin:.2rem 0 .8rem}
  .row{display:grid;grid-template-columns:1fr minmax(180px,1fr) auto;gap:10px}
  .unit{display:grid;grid-template-columns:minmax(140px,1fr) 44px;gap:8px}
  .calc input[type="number"]{text-align:right;font-variant-numeric:tabular-nums}
  .unit input[disabled]{width:44px;text-align:center;padding:8px}

  select,input{width:100%;border:1px solid var(--line);border-radius:10px;padding:10px 12px;background:#fff;color:var(--ink)}
  .unit{display:grid;grid-template-columns:1fr 56px;gap:8px}
  .calc button{width:100%;margin:6px 0 12px}
  .mini{border:1px solid var(--line);border-radius:12px;padding:10px}
  .mini table{width:100%;border-collapse:collapse;font-variant-numeric:tabular-nums}
  .mini th,.mini td{padding:8px 10px;border-bottom:1px solid var(--line);text-align:right}
  .mini th:first-child,.mini td:first-child{text-align:left}
  .kicker{color:var(--muted);font-size:14px;margin-top:10px}
  .footnote{max-width:1040px;margin:18px auto 0;padding:0 16px;color:var(--muted);font-size:14px}
  footer{max-width:1040px;margin:40px auto;padding:18px 16px;color:var(--muted);display:flex;justify-content:space-between;gap:12px;font-size:14px;border-top:1px solid var(--line)}
  .visually-hidden{position:absolute;clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;width:1px;overflow:hidden;white-space:nowrap}

  @media (max-width:960px){ .hero{grid-template-columns:1fr} }
</style>
</head>
<body>
  <header>
    <div class="brand">ThermoCalc Web</div>
    <nav class="nav">
      <a href="/">Home</a>
      <a href="/methods.html">Methods &amp; Validation</a>
      <a href="/purchase.html">Purchase</a>
    </nav>
  </header>

  <section class="hero">
    <div>
      <h1>Accurate Thermodynamic Data in Seconds â€” No Installation Required</h1>
      <p>Explore various thermodynamic values for molecules like CH<sub>4</sub>, O<sub>2</sub>, CO, and NH<sub>3</sub>. Perfect for <b>students</b>, <b>educators</b>, and <b>researchers</b>.</p>

      <div class="points">
        <div class="point"><i>âš¡</i><div><b>Instant Calculations</b><br><span class="kicker">Enter a molecule and temperature, get results immediately.</span></div></div>
        <div class="point"><i>âœ…</i><div><b>Validated Data</b><br><span class="kicker">Benchmarked against NIST CCCBDB.</span></div></div>
        <div class="point"><i>ðŸ“‚</i><div><b>Export Ready</b><br><span class="kicker">Upgrade for <b>CSV/PDF export</b> for assignments or research.</span></div></div>
        <div class="point"><i>ðŸŽ“</i><div><b>Education Friendly</b><br><span class="kicker">Great for homework checks, lectures, or self-study.</span></div></div>
      </div>

      <div class="cta">
        <a href="#calculator" class="btn btn-primary">Try Free Calculator</a>
        <a href="/purchase.html" class="btn btn-outline">Upgrade for CSV/PDF Export</a>
      </div>
    </div>

    <!-- Calculator -->
    <aside class="card calc" id="calculator" aria-label="Thermodynamic calculator">
      <h3>Thermodynamic Calculations</h3>
      <div class="row">
        <label class="visually-hidden" for="mol">Molecule</label>
        <select id="mol" aria-label="Molecule">
          <option value="CH4">CHâ‚„</option>
          <option value="O2">Oâ‚‚</option>
          <option value="CO">CO</option>
          <option value="NH3">NHâ‚ƒ</option>
        </select>

        <div class="unit">
          <label class="visually-hidden" for="temp">Temperature</label>
          <input id="temp" type="number" inputmode="numeric" min="0.000001" step="0.01" value="298.15" aria-label="Temperature (K)" />
          <input value="K" aria-label="Units K" disabled style="text-align:center;border:1px solid var(--line);border-radius:10px;background:#f8fafc;color:var(--muted)">
        </div>

        <button class="btn btn-primary" id="calc" type="button">Calculate</button>
      </div>

      <div class="mini" role="region" aria-label="Results">
        <table>
          <thead>
            <tr><th>Property</th><th>Value</th><th>Unit</th></tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>

      <p class="kicker">RRHO ideal gas: exact rotational J-sum, full electronic partition function, Sackurâ€“Tetrode translation, harmonic-oscillator vibration (pÂ° = 101 325 Pa).</p>
    </aside>
  </section>

  <p class="footnote">Looking for methodology and benchmarks? See <a href="/methods.html">Methods &amp; Validation</a>.</p>

  <footer>
    <div>Â© <span id="yr"></span> ThermoCalc Web. All rights reserved.</div>
    <div>Values computed from validated statistical thermodynamics models.</div>
  </footer>

<script>
/* ===== Physical constants ===== */
const R  = 8.31446261815324;   // J/(molÂ·K)
const kB = 1.380649e-23;       // J/K
const h  = 6.62607015e-34;     // JÂ·s
const c  = 299792458;          // m/s
const NA = 6.02214076e23;      // 1/mol
const PI = Math.PI;
const P_STD = 1.00000e5;       // Pa (101 325)

/* ===== Helpers ===== */
function thetaFromCm1(cm1){ return (h*c*cm1*100)/kB; }               // cm^-1 -> K
function thetasVib(arr){ return arr.map(thetaFromCm1); }
function thetasRotLinear(B){ return thetaFromCm1(B); }
function thetasRotNonlinear(A,B,C){ return [thetaFromCm1(A),thetaFromCm1(B),thetaFromCm1(C)]; }
function clampPos(x){ return Math.max(x,1e-12); }

/* ===== Vibrations ===== */
function U_vib(T, theta_v, includeZPE=false){
  let sum=0, Tpos=clampPos(T);
  for(const th of theta_v){
    const x=th/Tpos, ex=Math.exp(x);
    sum += th/(ex-1) + (includeZPE?0.5*th:0);
  }
  return R*sum;
}
function Cv_vib(T, theta_v){
  let s=0, Tpos=clampPos(T);
  for(const th of theta_v){
    const x=th/Tpos, ex=Math.exp(x), d=ex-1;
    s += x*x*(ex/(d*d));
  }
  return R*s;
}
function S_vib(T, theta_v){
  let s=0, Tpos=clampPos(T);
  for(const th of theta_v){
    const x=th/Tpos, ex=Math.exp(x);
    s += (x/(ex-1)) - Math.log(1-Math.exp(-x));
  }
  return R*s;
}

/* ===== Translation (molar, Sackurâ€“Tetrode) ===== */
function U_trans(T){ return 1.5*R*T; }
function Cv_trans(){ return 1.5*R; }
function S_trans(T,p,M){
  const m = M/NA; // single-molecule mass
  const factor = Math.pow((2*PI*m*kB*T)/(h*h),1.5) * (kB*T/p);
  return R*(Math.log(factor)+2.5);
}

/* ===== Electronic states: full multi-state q_el ===== */
function electronicContrib(T, states){
  // states: [{g, Te_cm1}]  â€” include ground with Te_cm1: 0
  let Z=0, M1=0, M2=0, Tpos=clampPos(T);
  for(const s of (states||[])){
    const E = thetaFromCm1(Number(s.Te_cm1)||0); // K
    const g = Number(s.g)||0;
    const w = g * Math.exp(-E/Tpos);
    Z += w; M1 += E*w; M2 += E*E*w;
  }
  if(Z<=0){ return {U:0, Cv:0, S:0}; }
  const Ebar = M1/Z, varE = Math.max(0, M2/Z - Ebar*Ebar);
  const U = R*Ebar;
  const Cv = R*(varE/(Tpos*Tpos));
  const S = R*Math.log(Z) + U/Tpos;
  return {U,Cv,S};
}

/* ===== Rotation (linear, exact sum with adaptive cap) ===== */
function rotLinearExact(T,sigma,theta_r,relTol=1e-12,Jcap=null){
  const Tpos=clampPos(T), th=clampPos(theta_r);
  // Good default covering high-T: ~5.25*sqrt(T/theta_r)+20
  const autoCap = Math.max(40, Math.ceil(5.25*Math.sqrt(Tpos/th)+20));
  const CAP = (Jcap==null)? autoCap : Jcap;

  let Z=0,M1=0,M2=0;
  for(let J=0; J<=CAP; J++){
    const JJ1=J*(J+1), g=(2*J+1), E=th*JJ1;
    const w=g*Math.exp(-E/Tpos);
    Z+=w; M1+=E*w; M2+=E*E*w;
    if(w<relTol*Math.max(Z,1) && J>5) break;
  }
  const lnq=Math.log(Z/sigma), Ebar=M1/Z, varE=Math.max(0,M2/Z - Ebar*Ebar);
  return { U:R*Ebar, Cv:R*(varE/(Tpos*Tpos)), S:R*lnq + (R*Ebar)/Tpos };
}

/* ===== Rotation (nonlinear) ===== */
function rotNonlinearExact(T,sigma,thetaA,thetaB,thetaC,relTol=1e-12,Jcap=120,nearlyTol=1e-8){
  const Tpos=clampPos(T);
  let Z=0,M1=0,M2=0;
  const isClose=(a,b)=>Math.abs(a-b)<=nearlyTol*Math.max(1,Math.abs(a),Math.abs(b));
  const spherical=isClose(thetaA,thetaB)&&isClose(thetaB,thetaC);
  const prolate=isClose(thetaB,thetaC)&&!spherical;
  const oblate=isClose(thetaA,thetaB)&&!spherical;

  if(spherical){
    const theta=(thetaA+thetaB+thetaC)/3;
    for(let J=0;J<=Jcap;J++){
      const E=theta*J*(J+1), g=(2*J+1)*(2*J+1), w=g*Math.exp(-E/Tpos);
      Z+=w; M1+=E*w; M2+=E*E*w; if(w<relTol*Math.max(Z,1)&&J>3) break;
    }
  }else if(prolate||oblate){
    if(prolate){
      const B=thetaB,A=thetaA,delta=A-B;
      for(let J=0;J<=Jcap;J++){
        const base=B*J*(J+1);
        for(let K=-J;K<=J;K++){
          const E=base+delta*K*K, gM=(2*J+1), w=gM*Math.exp(-E/Tpos);
          Z+=w; M1+=E*w; M2+=E*E*w;
        }
      }
    }else{
      const B=thetaA,C=thetaC,delta=C-B;
      for(let J=0;J<=Jcap;J++){
        const base=B*J*(J+1);
        for(let K=-J;K<=J;K++){
          const E=base+delta*K*K, gM=(2*J+1), w=gM*Math.exp(-E/Tpos);
          Z+=w; M1+=E*w; M2+=E*E*w;
        }
      }
    }
  }else{
    for(let J=0;J<=Jcap;J++){
      for(let K=-J;K<=J;K++){
        const E=0.5*(thetaA+thetaB)*(J*(J+1)-K*K) + thetaC*K*K;
        const gM=(2*J+1), w=gM*Math.exp(-E/Tpos);
        Z+=w; M1+=E*w; M2+=E*E*w;
      }
    }
  }
  const lnq=Math.log(Z/sigma), Ebar=M1/Z, varE=Math.max(0,M2/Z - Ebar*Ebar);
  return { U:R*Ebar, Cv:R*(varE/(Tpos*Tpos)), S:R*lnq + (R*Ebar)/Tpos };
}

/* ===== Master aggregator ===== */
function thermoRRHO(mol,T){
  const theta_v=thetasVib(mol.vib_cm1||[]);
  const Uv=U_vib(T,theta_v), Cvv=Cv_vib(T,theta_v), Sv=S_vib(T,theta_v);

  const Ut=U_trans(T), Cvt=Cv_trans(), St=S_trans(T,P_STD,mol.M_kg_per_mol);

  let Ur=0,Cvr=0,Sr=0;
  if(mol.kind==="linear"){
    const th=thetasRotLinear(mol.Brot_cm1);
    ({U:Ur,Cv:Cvr,S:Sr}=rotLinearExact(T,mol.sigma,th));
  }else{
    const [tA,tB,tC]=thetasRotNonlinear(mol.A_cm1,mol.B_cm1,mol.C_cm1);
    ({U:Ur,Cv:Cvr,S:Sr}=rotNonlinearExact(T,mol.sigma,tA,tB,tC));
  }

  // Always use full electronic partition function (multi-state)
  const {U:Uel,Cv:Cvel,S:Sel}=electronicContrib(T, mol.electronic || [{g:1,Te_cm1:0}]);

  const U = Ut + Ur + Uv + Uel;       // J/mol
  const Cv = Cvt + Cvr + Cvv + Cvel;  // J/(molÂ·K)
  const Cp = Cv + R;                  // J/(molÂ·K)
  const S  = St + Sr + Sv + Sel;      // J/(molÂ·K)
  const H  = U + R*T;                 // J/mol
  const G  = H - T*S;                 // J/mol

  return {Cp,Cv,S,U,H,G};
}

/* ===== Dataset with electronic states =====
   g values are degeneracies used in q_el; Te_cm1 are term energies (cm^-1).
   You can add/edit lists per species as needed. */
const molecules={
  CO:{ name:"CO", kind:"linear", M_kg_per_mol:0.02801, sigma:1, Brot_cm1:1.92253,
      vib_cm1:[2143],
      electronic:[ {g:1,Te_cm1:0} ] }, 
  
  O2:{ name:"O2", kind:"linear", M_kg_per_mol:0.031999, sigma:2, Brot_cm1:1.43768,
      vib_cm1:[1556],
      // Ground X^3Î£gâˆ’ (g=3) + two low-lying singlets (approx term energies).
      electronic:[
        {g:3, Te_cm1:0},     
        {g:2, Te_cm1:7918.1},  
        {g:1, Te_cm1:13195.1},
        {g:1, Te_cm1:33057.3}
      ] },

  CH4:{ name:"CH4", kind:"nonlinear", M_kg_per_mol:0.016042, sigma:12,
      A_cm1:5.2412, B_cm1:5.2412, C_cm1:5.2412,
      vib_cm1:[2917,1534,1534,3019,3019,3019,1306,1306,1306],
      electronic:[       
        {g:1, Te_cm1:0},  
        {g:1, Te_cm1:68730} ]  },

  NH3:{ name:"NH3", kind:"nonlinear", M_kg_per_mol:0.0170306, sigma:3,
      A_cm1:9.4443, B_cm1:9.4443, C_cm1:6.196,
      vib_cm1:[3337,950,3444,1627],
      electronic:[ {g:1,Te_cm1:0}, 
                {g:1, Te_cm1:46136} ]      }
};

/* ===== UI wiring ===== */
document.getElementById('yr').textContent=new Date().getFullYear();
const molSel=document.getElementById('mol'),
      tempEl=document.getElementById('temp'),
      tbody=document.getElementById('tbody');

document.getElementById('calc').addEventListener('click', computeAndRender);
window.addEventListener('DOMContentLoaded', computeAndRender);

function format(n,d=3){ return Number(n).toFixed(d); }

function computeAndRender(){
  const key=molSel.value;
  const T=parseFloat(tempEl.value);
  const mol=molecules[key];
  if(!mol || !(T>0)){
    tbody.innerHTML='<tr><td colspan="3">Enter a valid temperature &gt; 0 K.</td></tr>';
    return;
  }

  const r=thermoRRHO(mol,T);
  const rows=[
    ["C<sub>p</sub>", format(r.Cp), "J/(molÂ·K)"],
    ["C<sub>v</sub>", format(r.Cv), "J/(molÂ·K)"],
    ["S",             format(r.S ), "J/(molÂ·K)"],
    ["U",             format(r.U/1000,3), "kJ/mol"],
    ["H",             format(r.H/1000,3), "kJ/mol"],
    ["G",             format(r.G/1000,3), "kJ/mol"]
  ];
  tbody.innerHTML=rows.map(([k,v,u])=>`<tr><td><b>${k}</b></td><td>${v}</td><td>${u}</td></tr>`).join("");
}
</script>

</body>
</html>
